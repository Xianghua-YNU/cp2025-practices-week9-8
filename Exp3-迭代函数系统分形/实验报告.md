# 迭代函数系统(IFS)分形实验报告

## 实验目的

1. 理解迭代函数系统(IFS)的基本原理和算法
2. 掌握"混沌游戏"随机迭代方法
3. 实现巴恩斯利蕨和概率树的生成
4. 分析不同参数对分形图形的影响

## 实验过程

### 1. 核心算法实现

**IFS参数定义**:
- 巴恩斯利蕨: 4个仿射变换(茎干、小叶片、左右大叶片)
- 概率树: 3个仿射变换(树干、左右分支)

**混沌游戏算法**:
1. 初始化起始点
2. 随机选择变换(按概率)
3. 应用仿射变换生成新点
4. 重复迭代生成点集

### 2. 分形实现

**巴恩斯利蕨参数**:
- 茎干变换: 概率0.01
- 小叶片变换: 概率0.85
- 左右大叶片变换: 各概率0.07

**概率树参数**:
- 树干变换: 概率0.10
- 左右分支变换: 各概率0.45

### 3. 遇到的问题与解决

(请在此描述实现过程中遇到的问题及解决方法)

## 结果展示

### 1. 巴恩斯利蕨
[插入生成的巴恩斯利蕨分形图]![Figure_1](https://github.com/user-attachments/assets/5a068e53-4f4e-4140-b48a-37ed759d6a03)

- 展示不同变换对应的叶片部分：
 
- 对于巴恩斯利蕨，4个变换分别对应不同叶片部分。例如，变换T_1（概率p_1 = 0.01 ）对应蕨类的茎，从矩阵M_1=\begin{bmatrix}0.00&0.00\\0.00&0.16\end{bmatrix}可知，它主要是在y方向进行较小比例缩放 ，模拟茎的生长；T_2（概率p_2 = 0.85 ）对应逐渐变小的小叶，矩阵M_2=\begin{bmatrix}0.85&0.04\\ - 0.04&0.85\end{bmatrix}近似于等比例缩放并伴有小角度旋转，T_2概率大，使得生成的小叶数量多且密集。
 
- 分析概率参数对叶片密度的影响：概率p_i决定了对应变换的执行频率。如p_2 = 0.85 ，在大量迭代中，T_2被频繁选中，生成大量小叶，所以这部分叶片在分形图中密度大；而p_1 = 0.01 ，茎的部分出现频率低，在图中占比少。

### 2. 概率树 
[插入生成的概率树分形图]![probability_tree](https://github.com/user-attachments/assets/a171f71f-1207-4844-93ce-032a90c21fe6)

- 展示分支结构：概率树的变换中，如T_2（左分支）和T_3（右分支），通过矩阵中的缩放和旋转参数，分别生成向左和向右的分支。以T_2为例，矩阵M_2=\begin{bmatrix}0.42& - 0.42\\0.42&0.42\end{bmatrix} ，近似缩放0.6并旋转-45^{\circ} ，在迭代过程中不断生成左分支结构。
 
- 分析变换参数对树形的影响：变换矩阵中的缩放参数决定分支的粗细和长度变化，旋转参数决定分支的倾斜角度。比如增大T_2和T_3矩阵中的缩放系数，分支会变得更粗更长；改变旋转角度参数，分支倾斜方向和角度会改变 。

## 分析与思考

1. **IFS特性分析**
   - 仿射变换参数对图形各部分的影响：仿射变换矩阵M=\begin{bmatrix}a&b\\c&d\end{bmatrix} 中，a和d主要控制x和y方向的缩放，b和c控制旋转和剪切效果。例如在巴恩斯利蕨中，M_3=\begin{bmatrix}0.20& - 0.26\\0.23&0.22\end{bmatrix} ，a = 0.20 ，d = 0.22 使得对应叶片部分在两个方向有一定缩放，b=-0.26 ，c = 0.23 带来旋转效果，塑造出叶片独特形状。平移向量T=\begin{bmatrix}e\\f\end{bmatrix} 决定图形的位置偏移，像T_2的T_2=\begin{bmatrix}0.00\\1.60\end{bmatrix} 让对应叶片在y方向有位置提升。
 
- 概率参数与图形密度的关系：概率p_i大的变换在迭代中被选中次数多，其对应图形部分在分形图中出现频率高、密度大；概率小的变换对应部分在图中稀疏。如巴恩斯利蕨中，概率大的T_2使小叶密集，概率小的T_1让茎在图中占比小。
2. **参数实验**
- 修改概率参数的效果：以巴恩斯利蕨为例，若增大T_3（对应最大左叶）的概率p_3 ，会发现分形图中左叶部分变得更突出、更密集；若减小T_2的概率p_2 ，整体小叶密度会降低。在概率树中，改变某一分支的概率，会使该分支在树形结构中占比改变，比如增大左分支概率，左分支会更繁茂。
 
- 调整变换参数的效果：调整仿射变换矩阵中的参数，会改变图形形状、方向和大小。在概率树中，增大T_2矩阵的缩放系数，左分支会变长变粗；改变旋转角度参数，分支倾斜方向会改变。在巴恩斯利蕨中，微调M_4矩阵参数，会发现右叶形状和位置发生微妙变化。

3. **扩展思考**
- 如何设计新的IFS规则生成其他分形：确定一组新的仿射变换，比如定义不同的缩放、旋转和剪切参数组合，以及对应的平移向量，再为每个变换分配合适的概率。例如，设计一组变换模拟雪花形状，通过不同的缩放和旋转组合来构建雪花的分支结构，设置合适概率使各部分比例协调。
- 添加颜色渐变效果的方法：根据迭代次数或点的坐标位置映射颜色。比如，将迭代次数作为颜色索引，按照颜色表为不同迭代次数的点赋予不同颜色；或者根据点在x - y平面的位置，通过线性或非线性映射关系，将坐标值映射到颜色空间（如RGB空间），实现颜色渐变效果。
- 性能优化方案（减少点数同时保持视觉效果）：可以采用分层抽样方法，在迭代初期减少抽样点数，随着迭代进行，在关键区域增加抽样密度。或者使用聚类算法，将相近的点聚类，用少量代表点来近似表示大量相似点，减少最终绘制点数，同时保持分形图的整体视觉特征。
 

4. **算法比较**
- IFS与其他分形生成方法的对比：IFS通过随机迭代仿射变换生成图形，特点是随机性强，能通过简单规则生成复杂图形；相比之下，递归算法（如科赫曲线的生成）通过不断递归调用相同规则生成图形，更具确定性。迭代函数系统在模拟自然形态（如植物、云朵等）上有优势，递归算法在生成规则几何分形上更直观。
- 随机迭代与确定性迭代的差异：随机迭代引入概率因素，每次迭代结果有不确定性，生成图形具有丰富的细节和变化，不同次运行结果不完全相同；确定性迭代按照固定规则执行，每次运行结果一致，适合生成具有精确结构和重复性的分形图形。

**注：请在每一部分补充你自己的实验内容、图像、分析和关键代码。**
